# 浏览器输入url之后发生了什么？
## URL
http://www.billibili.com/dir/file1.html
* http就是访问协议，
* www.billibili.com是域名（也有直接用ip地址的），
* dir：目录名
* file1.html：文件名
## DNS查询
一般服务器是有ip但是比较抽象所以有了域名，就是这个域名可以映射到这个服务器ip。就是你给DNS这个域名他直接帮你找到这个ip
**DNS查询**可以从域名解读到服务器ip
### DNS查询顺序
其中一个成功，就直接跳到地址
* 浏览器自身DNS
* 操作系统DNS
* 本地host文件
* 向域名服务器发送请求
### DNS查找规则
先向本地DNS服务器中寻找，如果没有那就按这个顺序寻找(括号是示例)：
1、根域名服务器(.)->2、顶级域名服务器(com.)->3、权威域名服务器(baidu.com.)
找到ip之后就发送请求了

## 七层网络模型
发送请求
发送http请求，要遵循报文格式

## 浏览器的缓存
### 强缓存：让浏览器强制缓存服务器提供的资源
请求头里可以设置两个字段来设置缓存时间
1.Cache-Control:max-age=10   (强制缓存十秒)  [这个优先级更高]
2.Expires:Wed,21 .....       (缓存到指定时间)

* from disk cache:硬盘缓存
* from memory cache:内存缓存

### 协商缓存：一些缓存已经过期，但是资源没有改变，于是浏览器使用这个缓存返回304，如果资源改变，那么返回200同时带上最新资源
#### Last-Modified实现
* Last-Modified：GMT时间（最后被修改的时间）
* if-Modified-since: GMT时间
如果这两个时间相同，那不就表示资源没有改变吗?不过我看这个被吐槽的时一秒还是太长了，这是为啥？因为请求都是毫秒级的

* 比如一个被频繁访问的API端点，如果在一秒内被多个客户端请求，而资源在这期间更新了，那么Last-Modified就无法准确反映这种变化。
#### Etag实现（相当于文件标志）
* Etag:"djalksndklasndlk"  (假设是文件hash，也可以有其他的东西)
* if-None-Match:"dhjaklsldldada"
如果这两个标识不同，那就表示更新了

## TCP断开连接

## 渲染HTML页面
### 解析器将html解析成DOM树，css解析成styleSheets然后计算DOM节点的样式
### 绘制页面：回流重绘
回流：一些操作会导致DOM节点的大小和属性和文档流的位置有变化，浏览器就会重新渲染
重绘：颜色的改变等，浏览器将样式给元素并且重新绘制
### js
使用v8引擎解析